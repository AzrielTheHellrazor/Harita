<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Harita Uygulamasi</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />

    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='14' fill='%23d4a657'/%3E%3Ctext x='50%25' y='55%25' text-anchor='middle' font-size='28' fill='white' font-family='Inter,Arial' font-weight='700'%3EH%3C/text%3E%3C/svg%3E"
    />

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="top-bar">
        <div class="brand-group">
            <button id="menuToggle" class="hamburger" aria-label="Filtreleri ac/kapat">
                <span></span><span></span><span></span>
            </button>
            <button id="openSearch" class="icon-btn search-icon" aria-label="Mekan ara">
                üîç
            </button>
            <div class="brand">
                <h1>Yakin mekanlar</h1>
            </div>
        </div>
        <div class="actions">
            <button id="notificationButton" class="icon-btn bell" aria-label="Bildirimler">
                üîî
                <span id="notificationDot" class="notif-dot hidden" aria-hidden="true"></span>
            </button>
            <button id="btnKonum" class="pill primary">Konumumu Goster</button>
            <button id="openEventPanel" class="pill secondary">Etkinlikler</button>
            <button id="profileButton" class="icon-pill" aria-label="Profil">
                <span class="avatar">P</span>
                <span class="profile-label">Profil</span>
            </button>
        </div>
    </div>

    <div id="searchOverlay" class="search-overlay collapsed">
        <div class="search-shell">
            <input type="text" id="placeSearchInput" placeholder="Mekan ara" aria-label="Mekan ara">
            <button id="placeSearchBtn" class="pill secondary">Ara</button>
            <div id="searchSuggestions" class="search-suggestions hidden"></div>
        </div>
    </div>

    <section id="eventPanel" class="event-panel collapsed">
        <div class="event-header">
            <h2>Etkinlikler</h2>
            <div class="event-header-actions">
                <div class="mode-switch">
                    <button type="button" class="pill secondary" id="modeCreate">Olustur</button>
                    <button type="button" class="pill ghost" id="modeBrowse">Mevcutlari incele</button>
                </div>
                <button type="button" id="toggleFriendEvents" class="pill secondary friend-events-btn hidden">Gurmelerimin etkinlikleri</button>
            </div>
        </div>
        <div class="event-content">
            <form id="eventForm" class="event-form" data-section="create">
                <div class="event-grid">
                    <label class="field">
                        <span>Baslik</span>
                        <input id="eventTitle" type="text" placeholder="Orn: Brunch bulusmasi" required>
                    </label>
                    <label class="field">
                        <span>Tarih & Saat</span>
                        <input id="eventDate" type="datetime-local" required>
                    </label>
                </div>
                <label class="field">
                    <span>Aciklama</span>
                    <textarea id="eventDescription" rows="2" placeholder="Kisa not veya gereksinimler"></textarea>
                </label>
                <div class="field">
                    <span>Etkinlik icin kriter sec</span>
                    <div id="eventOptions" class="option-chip-list"></div>
                </div>
                <div class="field visibility-field">
                    <span>Herkese acik mi?</span>
                    <div class="radio-row">
                        <label><input type="radio" name="visibility" value="public" checked> Evet</label>
                        <label><input type="radio" name="visibility" value="private"> Hayir, secili e-postalar</label>
                    </div>
                    <input id="allowedEmails" type="text" placeholder="ornek@mail.com, diger@mail.com" class="hidden">
                    <p class="muted-text tiny">Hayir secersen e-posta listesi zorunlu.</p>
                </div>
                <div class="location-row">
                    <div>
                        <p id="eventLocationLabel" class="location-label">Konum secilmedi.</p>
                    </div>
                    <button type="button" id="eventSearchBtn" class="icon-btn search-icon" aria-label="Mekan ara">üîç</button>
                    <button type="button" id="pickLocation" class="pill ghost">Haritadan sec</button>
                </div>
                <button type="submit" class="pill primary full">Etkinlik olustur</button>
            </form>
            <div id="eventBrowse" class="event-browse section-hidden" data-section="browse">
                <div class="event-browse-grid">
                    <div class="browse-left">
                        <h3 class="section-title">Tum etkinlikler</h3>
                        <div class="event-list" id="eventList">Henuz etkinlik yok.</div>
                    </div>
                    <div class="browse-right">
                        <div class="my-events-block">
                            <h4>Olusturduklarim</h4>
                            <div id="myCreatedEvents" class="event-list compact empty">Etkinlik yok.</div>
                        </div>
                        <div class="my-events-block">
                            <h4>Katildiklarim</h4>
                            <div id="myJoinedEvents" class="event-list compact empty">Etkinlik yok.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <aside id="filterPanel" class="panel">
        <div class="panel-header">
            <div>
                <p class="eyebrow">Nasil bir mekan istedigin?</p>
                <h2>Filtrele</h2>
            </div>
            <button id="closeFilter" class="icon-btn hide-close" aria-label="Filtreyi kapat">&times;</button>
        </div>
        <form id="filterForm" class="filter-list">
            <div class="filter-group" data-criterion="Kategori">
                <button type="button" class="filter-main" data-criterion="Kategori">
                    Kategori
                    <span class="chevron">v</span>
                </button>
                <div class="sub-options">
                    <button type="button" class="chip-option" data-criterion="Kategori" data-option="Kafe">Kafe</button>
                    <button type="button" class="chip-option" data-criterion="Kategori" data-option="Restoran">Restoran</button>
                    <button type="button" class="chip-option" data-criterion="Kategori" data-option="Bar">Bar</button>
                </div>
            </div>

            <div class="filter-group" data-criterion="Isiklandirma">
                <button type="button" class="filter-main" data-criterion="Isiklandirma">
                    Isiklandirma
                    <span class="chevron">v</span>
                </button>
                <div class="sub-options">
                    <button type="button" class="chip-option" data-criterion="Isiklandirma" data-option="Los">Los</button>
                    <button type="button" class="chip-option" data-criterion="Isiklandirma" data-option="Dogal">Dogal</button>
                    <button type="button" class="chip-option" data-criterion="Isiklandirma" data-option="Canli">Canli</button>
                </div>
            </div>

            <div class="filter-group" data-criterion="Priz">
                <button type="button" class="filter-main" data-criterion="Priz">
                    Priz
                    <span class="chevron">v</span>
                </button>
                <div class="sub-options">
                    <button type="button" class="chip-option" data-criterion="Priz" data-option="Masada priz">Masada priz</button>
                </div>
            </div>

            <div class="filter-group" data-criterion="Ambiyans">
                <button type="button" class="filter-main" data-criterion="Ambiyans">
                    Ambiyans
                    <span class="chevron">v</span>
                </button>
                <div class="sub-options">
                    <button type="button" class="chip-option" data-criterion="Ambiyans" data-option="Retro">Retro</button>
                    <button type="button" class="chip-option" data-criterion="Ambiyans" data-option="Modern">Modern</button>
                </div>
            </div>

            <div class="filter-group" data-criterion="Oturma">
                <button type="button" class="filter-main" data-criterion="Oturma">
                    Oturma
                    <span class="chevron">v</span>
                </button>
                <div class="sub-options">
                    <button type="button" class="chip-option" data-criterion="Oturma" data-option="Koltuk var">Koltuk var</button>
                    <button type="button" class="chip-option" data-criterion="Oturma" data-option="Koltuk yok">Koltuk yok</button>
                </div>
            </div>

            <div class="filter-group" data-criterion="Deniz">
                <button type="button" class="filter-main" data-criterion="Deniz">
                    Deniz goruyor mu
                    <span class="chevron">v</span>
                </button>
                <div class="sub-options">
                    <button type="button" class="chip-option" data-criterion="Deniz" data-option="Deniz goruyor">Evet</button>
                    <button type="button" class="chip-option" data-criterion="Deniz" data-option="Deniz gormuyor">Hayir</button>
                </div>
            </div>

            <div class="filter-group" data-criterion="Sigara">
                <button type="button" class="filter-main" data-criterion="Sigara">
                    Sigara
                    <span class="chevron">v</span>
                </button>
                <div class="sub-options">
                    <button type="button" class="chip-option" data-criterion="Sigara" data-option="Sigara icilebilir">Icilir</button>
                    <button type="button" class="chip-option" data-criterion="Sigara" data-option="Kapali alanda sigara icilebilir">Kapali alanda icilir</button>
                </div>
            </div>

            <button type="button" id="resetFilters" class="pill ghost">Temizle</button>
            <button type="button" id="applyFilters" class="pill secondary">Filtreyi Uygula</button>
        </form>
    </aside>

    <div id="map"></div>

    <aside id="resultsPanel" class="panel results hidden">
        <div class="panel-header">
            <div>
                <p class="eyebrow">Sonuclar</p>
                <h2>Bulunan mekanlar</h2>
            </div>
            <button id="closeResults" class="icon-btn hide-close" aria-label="Sonuc listesini kapat">&times;</button>
        </div>
        <div id="resultsList" class="results-list empty">Sonuc yok.</div>
    </aside>

    <section id="detailPanel" class="panel detail hidden">
        <div class="panel-header">
            <div>
                <p id="placeType" class="eyebrow"></p>
                <h2 id="placeName">Bir mekan sec</h2>
                <div id="placeHours" class="muted-text tiny"></div>
                <div id="placeAddress" class="muted-text tiny"></div>
                <div id="placeTags" class="tags"></div>
            </div>
            <button id="closeDetail" class="icon-btn hide-close" aria-label="Detayi kapat">&times;</button>
        </div>

        <div id="placePhoto" class="place-photo hidden"></div>

        <div class="info-row" id="placeInfo"></div>

        <div class="reviews">
            <h3>Yorumlar</h3>
            <div id="reviewsList" class="review-list empty">Henuz yorum yok.</div>
        </div>

        <form id="reviewForm" class="review-form">
            <label for="comment">Yorumun</label>
            <textarea id="comment" name="comment" rows="3" placeholder="Kisa bir not birak"></textarea>

            <div class="criteria" id="criteriaInputs">
                <!-- 5 kriter JS ile gelecek -->
            </div>

            <div class="custom-criteria">
                <div class="custom-header">
                    <h4>Ek degerlendirme</h4>
                    <button type="button" id="addCriterion" class="pill ghost">+ Kriter ekle</button>
                </div>
                <div id="customCriteria"></div>
            </div>

            <button type="submit" class="pill primary full">Yorumu Kaydet</button>
        </form>
    </section>

    <section id="profilePanel" class="panel profile hidden">
        <div class="profile-hero">
            <div class="hero-avatar-wrap">
                <div class="hero-avatar" id="profileAvatarLarge" tabindex="0">P</div>
                <button type="button" id="avatarUploadBtn" class="avatar-upload-btn">Foto ekle</button>
                <input type="file" id="avatarInput" accept="image/*" capture="environment" class="hidden">
            </div>
            <div class="hero-main">
                <div class="hero-top">
                    <div>
                        <p class="eyebrow">Hesabim</p>
                        <h2 id="profileUsername">Giris yap</h2>
                        <p id="profileEmail" class="muted-text tiny">@kullanici</p>
                    </div>
                    <div class="hero-actions">
                        <button id="openSettings" class="pill secondary">Ayarlar</button>
                        <button id="signOut" class="pill ghost hidden">Cikis yap</button>
                        <button id="closeProfile" class="icon-btn hide-close" aria-label="Profili kapat">&times;</button>
                    </div>
                </div>
                <div class="profile-stats">
                    <button type="button" id="btnFollowing" class="stat linkish">
                        <strong id="followingCount">0</strong>
                        <span>Gurmelerim</span>
                    </button>
                    <button type="button" id="btnFollowers" class="stat linkish">
                        <strong id="followerCount">0</strong>
                        <span>Mudavimlerim</span>
                    </button>
                    <div class="stat review-centered">
                        <strong id="reviewCount">0</strong>
                        <span>Gurmenin yorumlari</span>
                    </div>
                </div>
                <p id="authState" class="muted-text bio-line">Giris yapmadin.</p>
            </div>
        </div>

        <div id="settingsPanel" class="settings-panel hidden">
            <div class="settings-row">
                <div>
                    <p class="eyebrow">Hesap durumu</p>
                    <p class="muted-text tiny">Acik: herkes ekleyebilir. Kapali: izin gerekir.</p>
                </div>
                <label class="switch">
                    <input type="checkbox" id="accountPrivacy">
                    <span class="slider"></span>
                    <span class="switch-label" data-on="Acik" data-off="Kapali"></span>
                </label>
            </div>
        </div>

        <div class="friends">
            <div class="friends-header">
                <div>
                    <h3>Gurme ekle</h3>
                    <p class="muted-text tiny friends-subtext">Kullanici adi veya e-posta ile ekle.</p>
                </div>
            </div>
            <form id="addFriendForm" class="friend-form">
                <input type="text" id="friendIdentifier" placeholder="Kullanici veya mail ara" required>
                <div id="friendSuggestions" class="connection-suggestions hidden"></div>
                <button type="submit" class="pill secondary full">Gurme ekle</button>
            </form>
        </div>

        <div id="connectionsSection" class="connections hidden">
            <div class="connections-header">
                <div>
                    <h4 id="connectionsTitle">Baglantilar</h4>
                    <p class="muted-text tiny" id="connectionsSubtitle">Gurme listesi</p>
                </div>
                <div class="connections-actions">
                    <button id="openConnectionSearch" class="icon-btn search-icon" aria-label="Kullanici ara">üîç</button>
                    <button id="closeConnections" class="icon-btn" aria-label="Kapat">&times;</button>
                </div>
            </div>
            <div id="connectionSearchBox" class="connection-search hidden">
                <input id="connectionSearchInput" type="text" placeholder="kullanici adi ara">
                <div id="connectionSuggestions" class="connection-suggestions hidden"></div>
            </div>
            <div id="connectionsList" class="chip-list empty">Bos.</div>
        </div>

        <div class="profile-reviews">
            <div class="reviews-header">
                <h3>Gurmenin yorumlari</h3>
                <p class="muted-text tiny">En yeni yorumlarin altta.</p>
            </div>
            <div id="myReviews" class="review-gallery empty">Yorum yok.</div>
        </div>
    </section>

    <section id="friendPanel" class="panel friend hidden">
        <div class="panel-header">
            <div>
                <p class="eyebrow">Gurme</p>
                <h2 id="friendTitle">Gurme profili</h2>
            </div>
            <button id="closeFriend" class="icon-btn" aria-label="Gurme panelini kapat">&times;</button>
        </div>
        <div class="friend-hero">
            <div id="friendAvatar" class="friend-avatar-lg">G</div>
            <div class="friend-hero-meta">
                <h3 id="friendUsername">@kullanici</h3>
                <p id="friendHandle" class="muted-text tiny">@kullanici</p>
                <p id="friendBio" class="muted-text tiny"></p>
            </div>
        </div>
        <div class="friend-stats-row">
            <div class="stat">
                <strong id="friendFollowingCount">0</strong>
                <span>Gurmeleri</span>
            </div>
            <div class="stat">
                <strong id="friendFollowerCount">0</strong>
                <span>Mudavimleri</span>
            </div>
        </div>
        <div class="friend-following">
            <h3>Gurmeleri</h3>
            <div id="friendFollowingList" class="chip-list empty">Bos.</div>
        </div>
        <div class="friend-followers">
            <h3>Mudavimleri</h3>
            <div id="friendFollowersList" class="chip-list empty">Bos.</div>
        </div>
        <div class="friend-reviews">
            <h3>Yorumlar</h3>
            <div id="friendReviewsList" class="review-list empty">Yorum yok.</div>
        </div>
    </section>

    <div id="authModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="authTitle">Giris yap</h3>
                <button id="closeAuth" class="icon-btn" aria-label="Kapat">&times;</button>
            </div>
            <form id="authForm" class="auth-form">
                <label for="username">Kullanici adi</label>
                <input type="text" id="username" name="username" required placeholder="essiz_kullanici">
                <label for="email">E-posta</label>
                <input type="email" id="email" name="email" required placeholder="ornek@mail.com">
                <label for="password">Sifre</label>
                <input type="password" id="password" name="password" required placeholder="******">
                <button type="submit" class="pill primary full" id="authSubmit">Giris yap</button>
            </form>
            <p class="muted-text switch-auth">
                Hesabin yok mu?
                <button id="toggleAuthMode" class="link-btn" type="button">Kayit ol</button>
            </p>
        </div>
    </div>

    <div id="toast" class="toast hidden"></div>
    <div id="notificationPanel" class="notification-panel hidden">
        <div class="notif-header">
            <h4>Davetiye</h4>
            <button id="closeNotification" class="icon-btn" aria-label="Kapat">&times;</button>
        </div>
        <div id="notificationList" class="notif-list empty">Bildirim yok.</div>
    </div>  

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>

    <script src="filtreleme.js"></script>
    <script src="gpt_labels.js"></script>
    <script src="etkinlikler.js"></script>
    <script src="script.js"></script>
</body>
</html>
